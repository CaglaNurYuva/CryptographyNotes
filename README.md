# CryptographyNotes

B11 Slide:

Slide1: C. 11. Security Attacks, Countermeasures and protocols Intruders 2 Intruders 3 • Intrusion and Intruder • Password Attacks • Denial of Service Attacks • What layer for security • Firewalls • Web Security
Slide2: Intruders significant issue for networked systems is hostile or unwanted access • either via network or local can identify classes of intruders: masquerader misfeasor clandestine user varying levels of competence
Slide3: Intruders clearly a growing publicized problem - from "Wily Hacker" in 1986/87 - to clearly escalating CERT stats may seem benign, but still cost resources may use compromised system to launch other attacks awareness of intruders has led to the development of CERTS
Slide4: Intruders: What Can They Do? Eavesdrop--(compromise routers, links, routing algorithms, or DNS) • Send arbitrary messages (including IP hdr) Replay recorded messages Modify messages in transit • Write malicious code and trick people into running it
Slide5: Intrusion Techniques • aim to gain access and/or increase privileges on a system • basic attack methodology target acquisition and information gathering initial access privilege escalation covering tracks key goal often is to acquire passwords so then exercise access rights of owner
Slide6: Intrusion Detection • inevitably will have security failures so need also to detect intrusions so can block if detected quickly act as deterrent collect info to improve security assume intruder will behave differently to a legitimate user but will have imperfect distinction between
Slide7: Approaches to Intrusion Detection • statistical anomaly detection threshold profile based • rule-based detection anomaly penetration identification
Slide8: Audit Records • fundamental tool for intrusion detection • native audit records part of all common multi-user O/S already present for use may not have info wanted in desired form • detection-specific audit records created specifically to collect wanted info at cost of additional overhead on system
Slide9: Statistical Anomaly Detection • threshold detection Approaches to intrusion Detection 7 Audit Records 8 count occurrences of specific event over time if exceed reasonable value assume intrusion alone is a crude & ineffective detector profile based characterize past behavior of users detect significant deviations from this profile usually multi-parameter
Slide 10: Audit Record Analysis • foundation of statistical approaches analyze records to get metrics over time counter, gauge, interval timer, resource use use various tests on these to determine if current behavior is acceptable mean & standard deviation, multivariate, markov process, time series, operational key advantage is no prior knowledge used
Slide 11: Rule-Based Intrusion Detection Statistical Anomaly Detection 9 • observe events on system & apply rules to decide if activity is suspicious or not • rule-based anomaly detection analyze historical audit records to identify usage patterns & auto-generate rules for them then observe current behavior & match against rules to see if conforms like statistical anomaly detection does not require prior knowledge of security flaws
Slide 12: Rule-Based Intrusion Detection • rule-based penetration identification uses expert systems technology with rules identifying known penetration, weakness patterns, or suspicious behavior compare audit records or states against rules rules usually machine & O/S specific rules are generated by experts who interview & codify knowledge of security admins - quality depends on how well this is done
Slide 13: Base-Rate Fallacy • practically an intrusion detection system needs to detect a substantial percentage of intrusions with few false alarms Rule-Based Intrusion Detection 11 if too few intrusions detected -> false security if too many false alarms -> ignore / waste time • this is very hard to do existing systems seem not to have a good record
Slide 14: Distributed Intrusion Detection • traditional focus is on single systems • but typically have networked systems more effective defense has these working together to detect intrusions • issues dealing with varying audit record formats integrity & confidentiality of networked data centralized or decentralized architecture
Slide 15: Distributed Intrusion Detection - Architecture LAN Monitor Host Host Agent module Router Central Manager Manager module 15 모모모 Distributed Intrusion Detection - Agent Implementation 13 Distributed Intrusion Detection 14 Distributed intrusion Detection- Architecture 모모모 WAN
Slide 16: Distributed Intrusion Detection - Agent Implementation OS audit information Filter Host Audit Record Logic Alerts Templates Notable activity Signatures Noteworthy sessions Modifications 16 Central Manager Query/ response Agent Protocol Machine
Slide 17: Honeypots decoy systems to lure attackers away from accessing critical systems to collect information of their activities to encourage attacker to stay on system so administrator can respond are filled with fabricated information • instrumented to collect detailed information on attackers activities Dinhributed Intro Dention- Agent Implementation 16 Honeypots single or multiple networked systems • cf IETF Intrusion Detection WG standards
Slide 18: Password Guessing one of the most common attacks attacker knows a login (from email/web page etc) then attempts to guess password for it defaults, short passwords, common word searches user info (variations on names, birthday, phone, common words/interests) exhaustively searching all possible passwords • check by login or against stolen password file success depends on password chosen by user surveys show many users choose poorly
Slide 19: Password Capture another attack involves password capture watching over shoulder as password is entered using a trojan horse program to collect monitoring an insecure network login eg. telnet, FTP, web, email extracting recorded info after successful login (web history/cache, last number dialed etc) using valid login/password can impersonate user users need to be educated to use suitable precautions/countermeasures
Slide 20: Password Management • front-line defense against intruders users supply both: - login - determines privileges of that user password - to identify them passwords often stored encrypted Unix uses multiple DES (variant with salt) more recent systems use crypto hash function • should protect password file on system
Slide 21: Password Studies • Purdue 1992 - many short passwords • Klein 1990 - many guessable passwords • conclusion is that users choose poor passwords too often • need some approach to counter this
Slide 22: Managing Passwords - Education can use policies and good user education • educate on importance of good passwords give guidelines for good passwords minimum length (>6) require a mix of upper & lower case letters, numbers, punctuation not dictionary words • but likely to be ignored by many users
Slide 23: Managing Passwords - Computer Generated • let computer create passwords • if random likely not memorisable, so will be written down (sticky label syndrome) even pronounceable not remembered • have history of poor user acceptance FIPS PUB 181 one of best generators has both description & sample code generates words from concatenating random pronounceable syllables
Slide 24: Managing Passwords - Reactive Checking • reactively run password guessing tools note that good dictionaries exist for almost any language/interest group Managing Passwords-Computer Generated 23 • cracked passwords are disabled • but is resource intensive Managing Passwords-Reactive Checking password guessing tools • bad passwords are vulnerable till found
Slide 25: Managing Passwords - Proactive Checking most promising approach to improving password security Managing Passwords-Computer Generated 23 • allow users to select own password but have system verify it is acceptable simple rule enforcement (see earlier slide) compare against dictionary of bad passwords use algorithmic (markov model or bloom filter) to detect poor choices
Slide 26: Distributed Denial of Service Attacks (DDoS) • Distributed Denial of Service (DDoS) attacks form a significant security threat • making networked systems unavailable by flooding with useless traffic using large numbers of "zombies" growing sophistication of attacks • defense technologies struggling to cope
Slide 27: Distributed Denial of Service Attacks (DDoS) Distributed Denial of Service Attacks (DDoS) --- 26 Distributed Denial of Service Attacks (DDoS) Constructing the DooS Attack Network Attack machine sped SYN Slave servers packets Internet ① SYNWACK packets --- Target Web server (a) Distributed SYN flood attack Attack machine 25 Target router 27 Reflector machines (a) Distributed ICMP attack
Slide 28: Constructing the DDoS Attack Network Distributed Denial of Service Attacks (DDoS) 27 must infect large number of zombies needs: Constructing the DDoS Attack Network 28 1. software to implement the DDoS attack 2. an unpatched vulnerability on many systems 3. scanning strategy to find vulnerable systems random, hit-list, topological, local subnet
Slide 29: DDoS Countermeasures three broad lines of defense: 1. attack prevention & preemption (before) 2. attack detection & filtering (during) DDoS Countermeasures 29 3. attack source traceback & ident (after) huge range of attack possibilities hence evolving countermeasures
Slide 30: Communication Security, What layer? DDoS Countermeasures 29 Layer 2 protects link hop-by-hop IP headers can be hidden from eavesdropper (protects against "traffic analysis") Layer 3/4 (more on next slide) protects end-to-end real-time conversation Upper layer (e.g., PGP, S/MIME) - protects msgs. Store/forward, not real-time
Slide 31: "Key Exchange" • Mutual authentication/session key creation (create "security association") • Good to cryptographically protect entire session (not just initial authentication) • Good to have new key for each session Examples Layer 3 vs layer & 32 - SSL/TLS or Secure Shell ("layer 4") IPsec ("layer 3")
Slide 32: Layer 3 vs layer 4 Layer 3 idea: don't change applications or API to applications, just OS layer 4 idea: don't change OS, only change application. They run on top of layer 4 (TCP/UDP)
Slide 33: ESP Encapsulating Security Payload IP Header Next Header = '50' (ESP) ESP Header Session ID Sequence # 30 "Kay Exchange 31 Encrypted Payload TCP = 6 UDP = 17 ESP = 50 IP = 4 Layer 3 vs layer a Encrypted Padding Pad Len NXT MIC Over ESP Header, Encrypted Payload/Pad/Padlen/NXT
Slide 34: Layer 3 vs layer 4 layer 3 technically superior Rogue packet problem • TCP doesn't participate in crypto, so attacker can inject bogus packet, no way for TCP to recover easier to do outboard hardware processing (since each packet independently encrypted) layer 4 easier to deploy • And unless API changes, layer 3 can't pass up authenticated identity
Slide 35: What's going on in IETF Security Area Layer 3 vs layer 4 34 • Kerberos • PKIX (certificate format) (see next slide) • S/MIME, PGP What's going on in IETF Security Area IPsec, SSL/TLS, Secure Shell ONSSEC 35 Examples 36 Firewall • SASL (syntax for negotiating auth protocol) • DNSSEC (public keys, signed data in DNS) • sacred (downloading credentials)
Slide 36: Examples 33 Layer 3 vs layer 4 34 • SNMP • Should be straightforward end-to-end security • But it has to work when the network is flaky What's going on in IETF Security Area 35 Examples 36 Firewall DNS not available LDAP database for retrieving certificates might be down, as might revocation infrastructure
Slide 37: Firewall seen evolution of information systems now everyone want to be on the Internet and to interconnect networks has persistent security concerns can't easily secure every system in org typically use a Firewall to provide perimeter defence as part of comprehensive security strategy
Slide 38: What is a Firewall? a choke point of control and monitoring • interconnects networks with differing trust imposes restrictions on network services only authorized traffic is allowed auditing and controlling access can implement alarms for abnormal behavior provide NAT & usage monitoring implement VPNs using IPSec must be immune to penetration
Slide 39: Firewall Limitations What is a Firewall? 38 • cannot protect from attacks bypassing it eg sneaker net, utility modems, trusted organisations, trusted services (eg SSL/SSH) cannot protect against internal threats eg disgruntled or colluding employees cannot protect against transfer of all virus infected programs or files because of huge range of O/S & file types
Slide 40: Firewalls - Packet Filters What is a Finnwalt? • simplest, fastest firewall component • foundation of any firewall system Firewall Limitations 39 • examine each IP packet (no context) and permit or deny according to rules • hence restrict access to services (ports) possible default policies that not expressly permitted is prohibited that not expressly prohibited is permitted
Slide 41: Firewalls - Packet Filters (a)Packet-filtering router
Slide 42: Web Security • Web now widely used by business, government, individuals • but Internet & Web are vulnerable • have a variety of threats - integrity confidentiality denial of service authentication • need added security mechanisms
Slide 43: SSL (Secure Socket Layer) transport layer security service originally developed by Netscape • version 3 designed with public input subsequently became Internet standard known as TLS (Transport Layer Security) uses TCP to provide a reliable end-to-end service • SSL has two layers of protocols
Slide 44: SSL Architecture 42 SSL (Secure Socket Layer) SSL Handshake Protocol SSL Change Cipher Spec Protocol TCP SSL Alert Protocol SSL Record Protocol HTTP 43 IP

